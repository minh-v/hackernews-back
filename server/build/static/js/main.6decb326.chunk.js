(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{187:function(e,t){},211:function(e,t,n){},212:function(e,t,n){},305:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n(41),r=n.n(a),c=(n(211),n(38)),i=(n(212),n(27)),o=n.n(i),u=n(37),l=n(24),d=n(199),j={MAGIC_API_KEY:"pk_live_35FBE7FE41B75731",api:"http://147.182.199.161:80",hasura_endpoint:"147.182.199.161:8080/v1/graphql"},m=function(e){return fetch(e,{credentials:"include"}).then((function(e){return e.json()}))};function b(){var e=Object(d.a)("".concat(j.api,"/user"),m),t=e.data,n=e.error;return t||n?t&&(null===t||void 0===t?void 0:t.user):{loading:!0}}var h,p,O,x,g,v,f,_,y,k,w,S=n(26),N=new(n(181).a)(j.MAGIC_API_KEY),$=n(163),I=n(200),T=n(331),C=n(99),q=n(94),A=n(2),P=$.a.SubMenu,L=function(){var e=b(),t=Object(S.g)(),n=Object(S.h)().pathname,s=Object(q.useMediaQuery)({query:"(max-width: 650px"}),a=function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(j.api,"/logout"),{credentials:"include"});case 2:return e.next=4,N.user.logout();case 4:t.go(0),t.push("/");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(A.jsxs)("div",{className:"header-nav",children:[Object(A.jsx)("div",{className:"header-start",children:Object(A.jsx)("div",{className:"title",children:Object(A.jsxs)($.a,{theme:"dark",mode:"horizontal",disabledOverflow:!0,selectedKeys:[n.split("/")[1]],children:[Object(A.jsx)($.a.Item,{children:Object(A.jsx)(l.b,{to:"/",children:"Home"},"home")},"home"),Object(A.jsx)($.a.Item,{children:Object(A.jsx)(l.b,{to:"/top/1",children:"Top"})},"top"),Object(A.jsx)($.a.Item,{children:Object(A.jsx)(l.b,{to:"/new/1",children:"New"})},"new")]})})}),(null===e||void 0===e?void 0:e.loading)?Object(A.jsx)("div",{}):(null===e||void 0===e?void 0:e.issuer)?Object(A.jsxs)("div",{className:"nav-menu",children:[!s&&Object(A.jsxs)($.a,{theme:"dark",mode:"horizontal",selectedKeys:[n.split("/")[1]],children:[Object(A.jsx)(C.a,{title:"Create Post",children:Object(A.jsx)($.a.Item,{children:Object(A.jsx)(l.b,{to:"/submit",children:Object(A.jsx)(I.a,{style:{fontSize:"24px"}})},"submit")},"submit")}),Object(A.jsx)($.a.Item,{children:Object(A.jsxs)(l.b,{to:"/user?id=".concat(e.username),children:[e.username," (",e.karma,")"]},"profile")},null===e||void 0===e?void 0:e.username),Object(A.jsx)($.a.Item,{onClick:a,children:Object(A.jsx)("div",{children:"Log out"})},"logout")]}),s&&Object(A.jsx)($.a,{theme:"dark",mode:"horizontal",selectedKeys:[n.split("/")[1]],triggerSubMenuAction:"click",children:Object(A.jsxs)(P,{icon:Object(A.jsx)(T.a,{style:{fontSize:"20px"}}),children:[Object(A.jsx)(C.a,{title:"Create Post",children:Object(A.jsx)($.a.Item,{children:Object(A.jsx)(l.b,{to:"/submit",children:Object(A.jsx)(I.a,{style:{fontSize:"24px"}})},"submit")},"submit")}),Object(A.jsx)($.a.Item,{children:Object(A.jsxs)(l.b,{to:"/user?id=".concat(e.username),children:[e.username," (",e.karma,")"]},"profile")},"profile"),Object(A.jsx)($.a.Item,{onClick:a,children:Object(A.jsx)("div",{children:"Log out"})},"logout")]},"SubMenu")})]}):Object(A.jsxs)("div",{className:"nav-menu",children:[!s&&Object(A.jsxs)($.a,{theme:"dark",mode:"horizontal",disabledOverflow:!0,selectedKeys:[n.split("/")[1]],children:[Object(A.jsx)($.a.Item,{children:Object(A.jsx)(l.b,{to:"/login",children:"Login"},"login")},"login"),Object(A.jsx)($.a.Item,{children:Object(A.jsx)(l.b,{to:"/signup",children:"Sign up"},"signup")},"signup")]}),s&&Object(A.jsx)($.a,{theme:"dark",mode:"horizontal",disabledOverflow:!0,selectedKeys:[n.split("/")[1]],children:Object(A.jsxs)(P,{icon:Object(A.jsx)(T.a,{style:{fontSize:"20px"}}),children:[Object(A.jsx)($.a.Item,{children:Object(A.jsx)(l.b,{to:"/login",children:"Login"},"login")},"login"),Object(A.jsx)($.a.Item,{children:Object(A.jsx)(l.b,{to:"/signup",children:"Signup"},"signup")},"signup")]},"SubMenu")})]})]})},z=n(105),E=n(62),M=n(323),J=n(324),V=n(104),F=n(322),Y=n(150),D=function(e){e.handleSearch;var t=b(),n=Object(S.g)();return Object(A.jsxs)("div",{className:"side-container",children:[Object(A.jsx)("div",{className:"side-search-div",children:Object(A.jsxs)(M.a,{onFinish:function(e){var t=e.search;n.push("/search?q=".concat(t,"/1"))},className:"side-search-bar",children:[Object(A.jsx)(M.a.Item,{name:"search",rules:[{required:!0,message:"Please no empty"}],style:{width:"80%",marginRight:"1rem"},children:Object(A.jsx)(J.a,{placeholder:"search",className:"side-search-input"})}),Object(A.jsx)(M.a.Item,{children:Object(A.jsx)(V.a,{htmlType:"submit",shape:"circle",icon:Object(A.jsx)(Y.a,{})})})]})}),Object(A.jsx)("div",{className:"side-card",children:Object(A.jsx)(F.a,{bordered:!1,children:Object(A.jsx)("div",{onClick:function(){t||(alert("You must be signed in to submit a link!"),n.push("/login"))},children:Object(A.jsx)(l.b,{to:"/submit",children:Object(A.jsx)(V.a,{type:"primary",className:"side-card-submit",children:"Submit a link"})})})})})]})},K=n(187),B=n.n(K),U=n(325),R=n(332),H=n(333),Q=n(334),G=function(e){var t=e.handleSignup,n=e.disabled;return Object(A.jsxs)("div",{children:[Object(A.jsx)(U.a,{title:"Sign Up",className:"form-header"}),Object(A.jsxs)(M.a,{onFinish:function(e){var n=e.email,s=e.username;t(n,s)},children:[Object(A.jsx)(M.a.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"}],children:Object(A.jsx)(J.a,{prefix:Object(A.jsx)(R.a,{className:"site-form-email-icon"}),placeholder:"Email"})}),Object(A.jsx)(M.a.Item,{name:"username",disabled:n,rules:[{required:!0,message:"Please input your username!"}],children:Object(A.jsx)(J.a,{prefix:Object(A.jsx)(H.a,{className:"site-form-user-icon"}),placeholder:"Username"})}),Object(A.jsx)(V.a,{type:"primary",disabled:n,htmlType:"submit",icon:Object(A.jsx)(Q.a,{}),className:"site-form-submit-button",children:"Sign up"})]})]})},W=n(328),X=n(196),Z=n(56),ee=n(326),te=Object(ee.a)(h||(h=Object(Z.a)(["\n  query checkDuplicate($email: String!, $username: String!) {\n    users(where: { _or: [{ username: { _eq: $username } }, { email: { _eq: $email } }] }) {\n      email\n      username\n    }\n  }\n"]))),ne=Object(ee.a)(p||(p=Object(Z.a)(["\n  query checkEmail($email: String!) {\n    users(where: { email: { _eq: $email } }) {\n      email\n    }\n  }\n"]))),se=Object(ee.a)(O||(O=Object(Z.a)(["\n  query get_user_data($username: String!) {\n    users(where: { username: { _eq: $username } }) {\n      createdAt\n      karma\n    }\n  }\n"]))),ae=(Object(ee.a)(x||(x=Object(Z.a)(["\n  query getPosts {\n    posts {\n      id\n      title\n      url\n      user {\n        issuer\n        username\n      }\n      createdAt\n      votes {\n        id\n        value\n      }\n    }\n  }\n"]))),Object(ee.a)(g||(g=Object(Z.a)(["\n  subscription getPost($id: Int!, $user_issuer: String) {\n    posts_by_pk(id: $id) {\n      createdAt\n      id\n      title\n      url\n      user {\n        issuer\n        username\n      }\n      votes: votes_aggregate {\n        aggregate {\n          sum {\n            value\n          }\n        }\n      }\n      userVotes: votes(where: { user_issuer: { _eq: $user_issuer } }) {\n        value\n      }\n      comments(order_by: { createdAt: desc }) {\n        id\n        parent_id\n        comment\n        createdAt\n        post_id\n        user {\n          username\n        }\n        userLike: comments_votes(where: { user_issuer: { _eq: $user_issuer } }) {\n          value\n          id\n        }\n        likes: comments_votes_aggregate(where: { value: { _eq: 1 } }) {\n          aggregate {\n            count\n          }\n        }\n        dislikes: comments_votes_aggregate(where: { value: { _eq: -1 } }) {\n          aggregate {\n            count\n          }\n        }\n      }\n      comments_aggregate {\n        aggregate {\n          count\n        }\n      }\n    }\n  }\n"])))),re=Object(ee.a)(v||(v=Object(Z.a)(["\n  subscription getPost($id: Int!, $user_issuer: String) {\n    posts_by_pk(id: $id) {\n      createdAt\n      id\n      title\n      url\n      user {\n        issuer\n        username\n      }\n      votes: votes_aggregate {\n        aggregate {\n          sum {\n            value\n          }\n        }\n      }\n      userVotes: votes(where: { user_issuer: { _eq: $user_issuer } }) {\n        value\n      }\n      comments(order_by: { comments_votes_aggregate: { sum: { value: desc } } }) {\n        id\n        parent_id\n        comment\n        createdAt\n        post_id\n        user {\n          username\n        }\n        userLike: comments_votes(where: { user_issuer: { _eq: $user_issuer } }) {\n          value\n          id\n        }\n        likes: comments_votes_aggregate(where: { value: { _eq: 1 } }) {\n          aggregate {\n            count\n          }\n        }\n        dislikes: comments_votes_aggregate(where: { value: { _eq: -1 } }) {\n          aggregate {\n            count\n          }\n        }\n      }\n      comments_aggregate {\n        aggregate {\n          count\n        }\n      }\n    }\n  }\n"]))),ce=Object(ee.a)(f||(f=Object(Z.a)(["\n  query get_posts_from_username($user_issuer: String, $username: String!, $limit: Int, $offset: Int) {\n    posts(order_by: { createdAt: desc }, limit: $limit, offset: $offset, where: { user: { username: { _eq: $username } } }) {\n      id\n      title\n      url\n      createdAt\n      votes: votes_aggregate {\n        aggregate {\n          sum {\n            value\n          }\n        }\n      }\n      userVotes: votes(where: { user_issuer: { _eq: $user_issuer } }) {\n        value\n      }\n      user {\n        issuer\n        username\n      }\n      comments_aggregate {\n        aggregate {\n          count\n        }\n      }\n    }\n  }\n"]))),ie=Object(ee.a)(_||(_=Object(Z.a)(["\n  query get_comments_from_username($username: String!, $user_issuer: String!, $limit: Int, $offset: Int) {\n    comments(where: { user: { username: { _eq: $username } } }, order_by: { createdAt: desc }, limit: $limit, offset: $offset) {\n      comment\n      createdAt\n      id\n      parent_id\n      user {\n        issuer\n        username\n      }\n      userLike: comments_votes(where: { user_issuer: { _eq: $user_issuer } }) {\n        value\n        id\n      }\n      likes: comments_votes_aggregate(where: { value: { _eq: 1 } }) {\n        aggregate {\n          count\n        }\n      }\n      dislikes: comments_votes_aggregate(where: { value: { _eq: -1 } }) {\n        aggregate {\n          count\n        }\n      }\n      post {\n        createdAt\n        id\n        title\n        url\n        id\n        title\n        url\n        createdAt\n        votes: votes_aggregate {\n          aggregate {\n            sum {\n              value\n            }\n          }\n        }\n        comments {\n          id\n        }\n        userVotes: votes(where: { user_issuer: { _eq: $user_issuer } }) {\n          value\n        }\n        user {\n          username\n        }\n        comments_aggregate {\n          aggregate {\n            count\n          }\n        }\n      }\n    }\n  }\n"]))),oe=Object(ee.a)(y||(y=Object(Z.a)(["\n  subscription subscribe_posts($user_issuer: String, $order: posts_order_by!, $limit: Int, $offset: Int, $search: String!) {\n    posts(\n      order_by: [$order]\n      limit: $limit\n      offset: $offset\n      where: { _or: [{ title: { _iregex: $search } }, { url: { _iregex: $search } }] }\n    ) {\n      id\n      title\n      url\n      createdAt\n      votes: votes_aggregate {\n        aggregate {\n          sum {\n            value\n          }\n        }\n      }\n      userVotes: votes(where: { user_issuer: { _eq: $user_issuer } }) {\n        value\n      }\n      user {\n        issuer\n        username\n      }\n      comments_aggregate {\n        aggregate {\n          count\n        }\n      }\n    }\n  }\n"]))),ue=Object(ee.a)(k||(k=Object(Z.a)(["\n  query search_posts_sorted_new($user_issuer: String, $limit: Int, $offset: Int, $search: String!) {\n    posts(\n      order_by: { createdAt: desc }\n      limit: $limit\n      offset: $offset\n      where: { _or: [{ title: { _iregex: $search } }, { url: { _iregex: $search } }] }\n    ) {\n      id\n      title\n      url\n      createdAt\n      votes: votes_aggregate {\n        aggregate {\n          sum {\n            value\n          }\n        }\n      }\n      userVotes: votes(where: { user_issuer: { _eq: $user_issuer } }) {\n        value\n      }\n      user {\n        issuer\n        username\n      }\n      comments_aggregate {\n        aggregate {\n          count\n        }\n      }\n    }\n  }\n"]))),le=Object(ee.a)(w||(w=Object(Z.a)(["\n  query search_posts_sorted_top($user_issuer: String, $limit: Int, $offset: Int, $search: String!) {\n    posts(\n      order_by: { votes_aggregate: { sum: { value: desc } } }\n      limit: $limit\n      offset: $offset\n      where: { _or: [{ title: { _iregex: $search } }, { url: { _iregex: $search } }] }\n    ) {\n      id\n      title\n      url\n      createdAt\n      votes: votes_aggregate {\n        aggregate {\n          sum {\n            value\n          }\n        }\n      }\n      userVotes: votes(where: { user_issuer: { _eq: $user_issuer } }) {\n        value\n      }\n      user {\n        issuer\n        username\n      }\n      comments_aggregate {\n        aggregate {\n          count\n        }\n      }\n    }\n  }\n"]))),de=function(){var e=Object(S.g)(),t=Object(s.useState)(!1),n=Object(c.a)(t,2),a=n[0],r=n[1],i=function(e){var t=Object(W.a)(e,{skip:!0}).refetch;return function(e){return t(e)}}(te),l=function(){var t=Object(u.a)(o.a.mark((function t(n,s){var a,c,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r(!0),t.next=3,i({email:n,username:s});case 3:if(a=t.sent,0===(c=a.data).users.length){t.next=10;break}return n===c.users[0].email&&X.b.error("This email address is already being used"),s===c.users[0].username&&X.b.error("This username is already being used"),r(!1),t.abrupt("return");case 10:return t.next=12,N.auth.loginWithMagicLink({email:n});case 12:return u=t.sent,t.next=15,fetch("".concat(j.api,"/signup"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Bearer "+u},body:JSON.stringify({username:s})});case 15:200===t.sent.status&&console.log("sign up successful"),r(!1),e.push("/");case 19:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();return Object(A.jsx)("div",{className:"signup-page",children:Object(A.jsx)(G,{handleSignup:l,disabled:a})})},je=function(e){var t=e.handleLogin,n=e.disabled;return Object(A.jsxs)("div",{children:[Object(A.jsx)(U.a,{title:"Log in",className:"form-header"}),Object(A.jsxs)(M.a,{onFinish:function(e){var n=e.email;t(n)},children:[Object(A.jsx)(M.a.Item,{name:"email",rules:[{required:!0,message:"Please input your email!"}],children:Object(A.jsx)(J.a,{prefix:Object(A.jsx)(R.a,{className:"site-form-email-icon"}),placeholder:"Email"})}),Object(A.jsx)(V.a,{type:"primary",disabled:n,htmlType:"submit",className:"site-form-submit-button",children:"Log in"})]})]})},me=function(){var e=Object(S.g)(),t=function(e){var t=Object(W.a)(e,{skip:!0}).refetch;return function(e){return t(e)}}(ne),n=function(){var n=Object(u.a)(o.a.mark((function n(s){var a,r;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t({email:s});case 2:if(a=n.sent,0!==a.data.users.length){n.next=7;break}return X.b.error("This email address is not in the system."),n.abrupt("return");case 7:return n.next=9,N.auth.loginWithMagicLink({email:s});case 9:return r=n.sent,n.next=12,fetch("".concat(j.api,"/login"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Bearer "+r}});case 12:200===n.sent.status&&console.log("login successful"),e.push("/"),e.go(0);case 16:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return Object(A.jsx)("div",{className:"login-page",children:Object(A.jsx)(je,{handleLogin:n})})},be=n(310),he=n(148),pe=n(320);function Oe(e){return function(e,t){var n=6e4,s=36e5,a=864e5,r=2592e6,c=31536e6,i=e-t;return i<2e4?"just now":i<n?"less than 1 min ago":i<s?Math.round(i/n)+" min ago":i<a?Math.round(i/s)+" hours ago":i<r?Math.round(i/a)+" days ago":i<c?Math.round(i/r)+" months ago":Math.round(i/c)+" years ago"}((new Date).getTime(),new Date(e).getTime())}var xe=n(335),ge=n(336),ve=n(337),fe=function(e,t){return e.includes(t)},_e=function(e){var t,n,a,r=e.post,i=e.selected,d=e.setSelected,m=e.index,h=b(),p=Object(S.g)(),O=(null===(t=r.votes)||void 0===t||null===(n=t.aggregate)||void 0===n?void 0:n.sum.value)||0,x=Object(s.useState)(!1),g=Object(c.a)(x,2),v=g[0],f=g[1],_=Object(s.useState)("delete"),y=Object(c.a)(_,2),k=y[0],w=y[1],N=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h){e.next=4;break}return alert("You must be signed in to vote!"),p.push("/signup"),e.abrupt("return");case 4:return e.next=6,fetch("".concat(j.api,"/vote"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({post_id:t.id,value:1,poster:r.user.issuer})});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h){e.next=4;break}return alert("You must be signed in to vote!"),p.push("/signup"),e.abrupt("return");case 4:return e.next=6,fetch("".concat(j.api,"/vote"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({post_id:t.id,value:-1,poster:r.user.issuer})});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h){e.next=4;break}return e.next=3,fetch("".concat(j.api,"/post"),{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({post_id:t.id})});case 3:w("deleted");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=0;r.userVotes&&(T=null===r||void 0===r||null===(a=r.userVotes[0])||void 0===a?void 0:a.value);return Object(A.jsx)("div",{className:!0===i?"post-selected":"post",onClick:function(){"function"===typeof d&&d(r.id)},children:Object(A.jsxs)(pe.b.Item,{children:[Object(A.jsxs)("div",{className:"post-index",children:[m,"."]}),Object(A.jsx)("div",{children:1===T?Object(A.jsxs)("div",{className:"vote",children:[Object(A.jsx)(V.a,{type:"link",htmlType:"submit",icon:Object(A.jsx)(xe.a,{twoToneColor:"#52c41a"}),onClick:function(){return N(r)}}),Object(A.jsx)("span",{className:"totalVotesUp",children:O}),Object(A.jsx)(V.a,{type:"link",htmlType:"submit",icon:Object(A.jsx)(ge.a,{}),onClick:function(){return $(r)}})]}):-1===T?Object(A.jsxs)("div",{className:"vote",children:[Object(A.jsx)(V.a,{type:"link",htmlType:"submit",icon:Object(A.jsx)(xe.a,{}),onClick:function(){return N(r)}}),Object(A.jsx)("span",{className:"totalVotesDown",children:O}),Object(A.jsx)(V.a,{type:"link",htmlType:"submit",icon:Object(A.jsx)(ge.a,{twoToneColor:"#eb2f96"}),onClick:function(){return $(r)}})]}):Object(A.jsxs)("div",{className:"vote",children:[Object(A.jsx)(V.a,{type:"link",htmlType:"submit",icon:Object(A.jsx)(xe.a,{}),onClick:function(){return N(r)}}),Object(A.jsx)("span",{className:"totalVotes",children:O}),Object(A.jsx)(V.a,{type:"link",htmlType:"submit",icon:Object(A.jsx)(ge.a,{}),onClick:function(){return $(r)}})]})}),Object(A.jsx)("div",{className:"thumbnail",children:Object(A.jsx)(pe.b.Item,{children:Object(A.jsx)(ve.a,{})})}),Object(A.jsx)(pe.b.Item.Meta,{title:Object(A.jsxs)("a",{href:"//".concat(r.url),children:[r.title," (getHostName(post.url))"]}),description:Object(A.jsxs)("p",{children:["by ",Object(A.jsx)(l.b,{to:"/user?id=".concat(r.user.username),children:r.user.username})," ",Oe(r.createdAt)," |"," ",Object(A.jsxs)(l.b,{to:"/post?id=".concat(r.id),children:[r.comments_aggregate.aggregate.count," comments"]})," ",r.user.username===(null===h||void 0===h?void 0:h.username)?Object(A.jsxs)("span",{onClick:function(){return f(!v)},children:["|"," ",v?Object(A.jsxs)("span",{children:["are you sure?"," ",Object(A.jsx)("span",{className:"deleteConfirmation",onClick:function(){return I(r)},children:"yes"}),"/no"]}):k]}):null]})})]})})},ye=n(202),ke=n(201),we=function(e){var t,n,a,r=e.posts,i=e.pageIndex,o="search",u=Object(S.g)(),l=u.location.pathname;if(fe(l,o)){var d=u.location.search.split("/")[0];a=parseInt(u.location.search.split("/")[1]),t=l+d+"/"+(a-1),n=l+d+"/"+(a+1)}else if(fe(l,"submitted")||fe(l,"comments")){var j=l.split("/");a=parseInt(j[j.length-1]);var m=j[j.length-2];t="/submitted/"+m+"/"+(a-1),n="/submitted/"+m+"/"+(a+1)}else{var b=l.split("/");a=parseInt(b[b.length-1]);var h=b[b.length-2];t="/"+h+"/"+(a-1),n="/"+h+"/"+(a+1)}var p=Object(s.useState)(null),O=Object(c.a)(p,2),x=O[0],g=O[1],v=Object(q.useMediaQuery)({query:"(max-width: 768px"});return Object(A.jsxs)("div",{children:[v&&!fe(l,o)&&Object(A.jsx)("div",{clasName:"small-side",children:Object(A.jsx)(D,{})}),Object(A.jsx)(pe.b,{itemLayout:"horizontal",dataSource:r,renderItem:function(e){return Object(A.jsxs)("div",{children:[Object(A.jsx)("div",{className:"small-spacer"}),Object(A.jsx)(_e,{post:e,selected:x===e.id,setSelected:g,index:r.indexOf(e)+i+1},e.id)]})}}),Object(A.jsxs)("div",{className:"navigation-button",children:[a>1?Object(A.jsx)("div",{className:"previous-button",onClick:function(){a>1&&u.push(t)},children:Object(A.jsx)(V.a,{children:Object(A.jsx)(ye.a,{style:{fontSize:"20px"}})})}):null,5===r.length?Object(A.jsx)("div",{className:"next-button",onClick:function(){u.push(n)},children:Object(A.jsx)(V.a,{children:Object(A.jsx)(ke.a,{style:{fontSize:"20px"}})})}):null]})]})},Se=n(107),Ne=function(e){var t=b(),n=Object(S.g)(),s=e.location.search.split("&"),a=1,r="new",c=s[0].split("/");s.length>1?(a=s[1].split("=")[1].split("/")[1],r=s[1].split("=")[1].split("/")[0]):a=parseInt(c[c.length-1]);var i=c[0].split("=")[1],o="new"===r?ue:le,u=5*(a-1),d=Object(W.a)(o,{variables:{user_issuer:t?null===t||void 0===t?void 0:t.issuer:"",offset:u,limit:5,search:i}}),j=d.data,m=d.loading,h=Object(A.jsxs)($.a,{children:[Object(A.jsx)(l.b,{to:"".concat(s[0],"/1"),children:Object(A.jsx)($.a.Item,{children:"new"},"new")}),Object(A.jsx)(l.b,{to:"".concat(c[0],"&sort=top/1"),children:Object(A.jsx)($.a.Item,{children:"top"},"top")})]});return m||!j?Object(A.jsx)("div",{children:"loading.."}):0===j.posts.length?Object(A.jsxs)("div",{children:[Object(A.jsx)(Se.a,{}),Object(A.jsx)("span",{className:"previous-button",onClick:function(){a>1&&n.push("/search".concat(n.location.search.split("/")[0],"/").concat(a-1))},children:Object(A.jsx)(V.a,{children:Object(A.jsx)(ye.a,{style:{fontSize:"20px"}})})})]}):Object(A.jsxs)("div",{children:[Object(A.jsxs)(M.a,{onFinish:function(e){var t=e.search;n.push("/search?q=".concat(t,"/1"))},className:"search-form",children:[Object(A.jsx)(M.a.Item,{name:"search",rules:[{required:!0,message:"Please no empty"}],initialValue:i,children:Object(A.jsx)(J.a,{placeholder:"search",value:"forceds"})}),Object(A.jsx)(M.a.Item,{children:Object(A.jsx)(V.a,{htmlType:"submit",shape:"circle",icon:Object(A.jsx)(Y.a,{})})})]}),Object(A.jsxs)("span",{className:"comment-sort",children:["sorted by"," ",Object(A.jsx)(be.a,{overlay:h,trigger:["click"],children:Object(A.jsxs)("span",{className:"comment-select",children:[r," ",Object(A.jsx)(he.a,{})]})})]}),Object(A.jsx)("div",{children:Object(A.jsx)(we,{posts:null===j||void 0===j?void 0:j.posts,pageIndex:u})})]})},$e=function(e){var t=e.handleSubmit;return Object(A.jsxs)("div",{children:[Object(A.jsx)(U.a,{title:"Submit link",className:"form-header"}),Object(A.jsxs)(M.a,{onFinish:function(e){var n=e.title,s=e.url;t(n,s)},children:[Object(A.jsx)(M.a.Item,{label:"Title",name:"title",rules:[{required:!0,message:"Title field must not be empty"}],children:Object(A.jsx)(J.a,{})}),Object(A.jsx)(M.a.Item,{label:"URL",name:"url",rules:[{required:!0,message:"Url field must not be empty"}],children:Object(A.jsx)(J.a,{})}),Object(A.jsx)(V.a,{type:"primary",htmlType:"submit",className:"site-form-submit-button",children:"Submit"})]})]})},Ie=function(){var e=Object(S.g)(),t=function(){var t=Object(u.a)(o.a.mark((function t(n,s){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(j.api,"/post"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:n,url:s})});case 2:console.log("submittd"),e.push("/");case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();return Object(A.jsx)("div",{className:"submit-page",children:Object(A.jsx)($e,{handleSubmit:t})})},Te=n(329),Ce=n(311),qe=n(338),Ae=n(339),Pe=n(340),Le=n(341),ze=J.a.TextArea,Ee=function e(t){var n,a=t.comment,r=t.children,i=t.comments,d=b(),m=Object(S.g)(),h=Object(s.useState)(!1),p=Object(c.a)(h,2),O=p[0],x=p[1],g=Object(s.useState)(!1),v=Object(c.a)(g,2),f=v[0],_=v[1],y=Object(s.useState)(a.likes.aggregate.count),k=Object(c.a)(y,2),w=k[0],N=k[1],$=Object(s.useState)(a.dislikes.aggregate.count),I=Object(c.a)($,2),T=I[0],C=I[1],q=Object(s.useState)((null===(n=a.userLike[0])||void 0===n?void 0:n.value)||null),P=Object(c.a)(q,2),L=P[0],z=P[1],E=Object(s.useState)(!1),J=Object(c.a)(E,2),F=J[0],Y=J[1],D=function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d||(alert("You must be signed in to comment!"),m.push("/login")),n=t.reply,e.next=4,fetch("".concat(j.api,"/comment"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({post_id:a.post_id,comment:n,parent_id:a.id})});case 4:x(!O),m.go(0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=4;break}return alert("You must be signed in to vote!"),m.push("/signup"),e.abrupt("return");case 4:if(Y(!0),1!==L){e.next=12;break}return N(w-1),z(null),e.next=10,fetch("".concat(j.api,"/comment-vote"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment_id:a.id,value:0,id:null===(t=a.userLike[0])||void 0===t?void 0:t.id})});case 10:e.next=24;break;case 12:if(-1!==L){e.next=20;break}return N(w+1),C(T-1),z(1),e.next=18,fetch("".concat(j.api,"/comment-vote"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment_id:a.id,value:1})});case 18:e.next=24;break;case 20:return N(w+1),z(1),e.next=24,fetch("".concat(j.api,"/comment-vote"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment_id:a.id,value:1})});case 24:Y(!1);case 25:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=4;break}return alert("You must be signed in to vote!"),m.push("/signup"),e.abrupt("return");case 4:if(Y(!0),-1!==L){e.next=12;break}return C(T-1),z(null),e.next=10,fetch("".concat(j.api,"/comment-vote"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment_id:a.id,value:0,id:null===(t=a.userLike[0])||void 0===t?void 0:t.id})});case 10:e.next=24;break;case 12:if(1!==L){e.next=20;break}return N(w-1),C(T+1),z(-1),e.next=18,fetch("".concat(j.api,"/comment-vote"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment_id:a.id,value:-1})});case 18:e.next=24;break;case 20:return C(T+1),z(-1),e.next=24,fetch("".concat(j.api,"/comment-vote"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment_id:a.id,value:-1})});case 24:Y(!1);case 25:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d){e.next=3;break}return e.next=3,fetch("".concat(j.api,"/comment"),{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({comment_id:t.id})});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=[Object(A.jsxs)("span",{onClick:K,children:[1===L?Object(A.jsx)(qe.a,{}):Object(A.jsx)(Ae.a,{}),Object(A.jsx)("span",{className:"comment-action",children:w})]}),Object(A.jsxs)("span",{onClick:B,children:[-1===L?Object(A.jsx)(Pe.a,{}):Object(A.jsx)(Le.a,{}),Object(A.jsx)("span",{className:"comment-action",children:T})]}),Object(A.jsx)("span",{onClick:function(){return x(!O)},children:"Reply to"},"comment-reply-to"),Object(A.jsx)("span",{onClick:function(){return _(!f)},children:a.user.username===(null===d||void 0===d?void 0:d.username)?f?Object(A.jsxs)("span",{children:["are you sure?"," ",Object(A.jsx)("span",{className:"deleteConfirmation",onClick:function(){return U(a)},children:"yes"}),"/no"]}):"delete":null})];return Object(A.jsxs)("div",{className:"comment-div",disabled:F,children:[(null===r||void 0===r?void 0:r.length)>0?Object(A.jsx)(Ce.a,{actions:R,author:Object(A.jsx)(l.b,{to:"/user?id=".concat(a.user.username),children:a.user.username}),content:a.comment,datetime:Oe(a.createdAt),children:r.map((function(t){return Object(A.jsx)(e,{comment:t,comments:i,children:i.filter((function(e){return e.parent_id===t.id}))})}))}):Object(A.jsx)(Ce.a,{actions:R,author:Object(A.jsx)(l.b,{to:"/user?id=".concat(a.user.username),children:a.user.username}),content:a.comment,datetime:Oe(a.createdAt)}),O?Object(A.jsxs)(M.a,{onFinish:D,children:[Object(A.jsx)(M.a.Item,{name:"reply",rules:[{required:!0,message:"Cannot enter empty reply"}],children:Object(A.jsx)(ze,{})}),Object(A.jsx)(V.a,{htmlType:"submit",children:"reply"})]}):null]},a.id)},Me=function(e){var t=e.comments,n=e.baseComments;return Object(A.jsx)("div",{children:Object(A.jsx)(pe.b,{className:"comment-list",itemLayout:"horizontal",dataSource:n,renderItem:function(e){return Object(A.jsx)(Ee,{comment:e,comments:t,children:t.filter((function(t){return t.parent_id===e.id}))})}})})},Je=J.a.TextArea,Ve=function(e){var t=b(),n=Object(S.g)(),a=e.location.search.split("&"),r=a[0].split("=")[1],i="new";a.length>1&&(i=a[1].split("=")[1]);var d=M.a.useForm(),m=Object(c.a)(d,1)[0],h="new"===i?ae:"top"===i?re:ae,p=Object(Te.a)(h,{variables:{id:parseInt(r),user_issuer:t?null===t||void 0===t?void 0:t.issuer:""}}),O=p.data,x=p.loading,g=Object(s.useState)("new"),v=Object(c.a)(g,2),f=v[0],_=v[1],y=function(){var e=Object(u.a)(o.a.mark((function e(s){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t||(alert("You must be signed in to comment!"),n.push("/login")),a=s.comment,e.next=4,fetch("".concat(j.api,"/comment"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({post_id:O.posts_by_pk.id,comment:a})});case 4:m.resetFields();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=Object(A.jsxs)($.a,{children:[Object(A.jsx)(l.b,{to:"".concat(e.location.pathname).concat(a[0]),children:Object(A.jsx)($.a.Item,{onClick:function(){return _("new")},children:"new"},"new")}),Object(A.jsx)(l.b,{to:"".concat(e.location.pathname).concat(a[0],"&sort=top"),children:Object(A.jsx)($.a.Item,{onClick:function(){return _("top")},children:"top"},"top")})]});return x?Object(A.jsx)("div",{children:"loading..."}):Object(A.jsxs)("div",{children:[Object(A.jsx)(_e,{post:O.posts_by_pk}),Object(A.jsxs)("span",{className:"comment-sort",children:["sorted by"," ",Object(A.jsx)(be.a,{overlay:k,trigger:["click"],children:Object(A.jsxs)("span",{className:"comment-select",children:[f," ",Object(A.jsx)(he.a,{})]})})]}),Object(A.jsxs)(M.a,{onFinish:y,form:m,children:[Object(A.jsx)(M.a.Item,{name:"comment",rules:[{required:!0,message:"Cannot enter empty comment"}],children:Object(A.jsx)(Je,{})}),Object(A.jsx)(V.a,{type:"primary",htmlType:"submit",children:"Add comment"})]}),"new"===f?Object(A.jsx)(Me,{comments:O.posts_by_pk.comments,baseComments:O.posts_by_pk.comments.filter((function(e){return null===e.parent_id}))}):Object(A.jsx)(Me,{comments:O.posts_by_pk.comments,baseComments:O.posts_by_pk.comments.filter((function(e){return null===e.parent_id})).sort((function(e,t){return t.likes.aggregate.count-e.likes.aggregate.count}))})]})},Fe=function(e){var t=e.location.search.split("=")[1],n=Object(W.a)(se,{variables:{username:t}}),s=n.data;if(n.loading)return Object(A.jsx)("div",{children:"loading.."});var a=new Date(s.users[0].createdAt);return Object(A.jsxs)("div",{children:["user: ",t,Object(A.jsx)("br",{}),"created: ",a.toDateString(),Object(A.jsx)("br",{}),"karma: ",s.users[0].karma,Object(A.jsxs)("span",{children:[Object(A.jsx)("br",{}),"about: ",Object(A.jsx)(l.b,{to:"/submitted/".concat(t,"/1"),children:"submissions"}),", ",Object(A.jsx)(l.b,{to:"/comments/".concat(t,"/1"),children:"comments"})]})]})},Ye=function(e){var t=b(),n=e.location.pathname.split("/");console.log(n);var s=n[n.length-1],a=n[n.length-2],r=5*(s-1),c=Object(W.a)(ce,{variables:{username:a,user_issuer:(null===t||void 0===t?void 0:t.issuer)||"",offset:r,limit:5}}),i=c.data;return c.loading?Object(A.jsx)("div",{children:"loading.."}):Object(A.jsxs)("div",{children:[Object(A.jsxs)("h1",{children:[a,"'s submissions "]}),Object(A.jsx)(we,{posts:i.posts,pageIndex:r})]})},De=n(312),Ke=function(e){var t=b(),n=e.location.pathname.split("/"),s=n[n.length-1],a=n[n.length-2],r=5*(s-1),c=Object(W.a)(ie,{variables:{username:a,user_issuer:t?null===t||void 0===t?void 0:t.issuer:"",offset:r,limit:5}}),i=c.data;return c.loading?Object(A.jsx)("div",{children:"loading.."}):Object(A.jsx)("div",{children:i.comments.length>0?i.comments.map((function(e){return Object(A.jsxs)("div",{children:[Object(A.jsx)(_e,{post:e.post}),Object(A.jsx)(Ee,{comment:e,comments:e}),Object(A.jsx)(De.a,{})]})})):Object(A.jsx)("div",{children:Object(A.jsx)(Se.a,{})})})},Be=function(){var e=b(),t=Object(S.g)(),n=t.location.pathname.split("/"),a=parseInt(n[n.length-1]),r=5*(a-1),c=Object(Te.a)(oe,{variables:{user_issuer:e?null===e||void 0===e?void 0:e.issuer:"",offset:r,limit:5,order:{votes_aggregate:{sum:{value:"desc_nulls_last"}}},search:""}}),i=c.data,o=c.loading;return Object(s.useEffect)((function(){i&&(i.posts.forEach((function(e){null===e.votes.aggregate.sum.value&&(e.votes.aggregate.sum.value=0)})),i.posts.sort((function(e,t){return t.votes.aggregate.sum.value-e.votes.aggregate.sum.value})))}),[i]),o||!i?Object(A.jsx)("div",{children:"loading..."}):0===i.posts.length?Object(A.jsxs)("div",{children:[Object(A.jsx)(Se.a,{}),Object(A.jsx)("span",{className:"previous-button",onClick:function(){a>1&&t.push("/new/".concat(a-1))},children:Object(A.jsx)(V.a,{children:Object(A.jsx)(ye.a,{style:{fontSize:"20px"}})})})]}):Object(A.jsx)("div",{children:Object(A.jsx)(we,{posts:i.posts,pageIndex:r})})},Ue=n(313),Re=function(){var e=b(),t=Object(S.g)(),n=t.location.pathname.split("/"),s=parseInt(n[n.length-1]),a=5*(s-1),r=Object(Te.a)(oe,{variables:{user_issuer:e?null===e||void 0===e?void 0:e.issuer:"",offset:a,limit:5,order:{createdAt:"desc"},search:""}}),c=r.data;return r.loading||!c?Object(A.jsx)("div",{children:"loading..."}):0===c.posts.length?Object(A.jsxs)("div",{children:[Object(A.jsx)(Se.a,{}),Object(A.jsx)("span",{className:"previous-button",onClick:function(){s>1&&t.push("/new/".concat(s-1))},children:Object(A.jsx)(V.a,{children:Object(A.jsx)(ye.a,{style:{fontSize:"20px"}})})})]}):Object(A.jsx)("div",{children:Object(A.jsx)(we,{posts:c.posts,pageIndex:a})})},He=Ue.a.Header,Qe=Ue.a.Content,Ge=Ue.a.Sider,We=function(){var e=Object(s.useState)(!0),t=Object(c.a)(e,2),n=t[0],a=t[1],r=Object(S.h)(),i="";Object(s.useEffect)((function(){var e=r.pathname;i=e.split("/")[1],a("signup"!==i&&"login"!==i&&"search"!==i&&"submit"!==i)}),[r]);var o=Object(q.useMediaQuery)({query:"(max-width: 768px"});return Object(A.jsx)("div",{className:"app",children:Object(A.jsxs)(Ue.a,{className:"app-layout",children:[Object(A.jsx)(z.a,{children:Object(A.jsx)(E.a,{span:24,children:Object(A.jsx)(He,{className:"header",children:Object(A.jsx)(L,{})})})}),Object(A.jsx)(z.a,{children:Object(A.jsxs)(Ue.a,{className:"content-layout",children:[Object(A.jsx)(E.a,{xs:24,md:n?18:24,children:Object(A.jsx)(Qe,{className:"content",children:Object(A.jsxs)("div",{className:"content-div",children:[!o&&Object(A.jsx)("div",{className:"spacer"}),Object(A.jsxs)(S.d,{children:[Object(A.jsx)(S.b,{exact:!0,path:"/",forceRefresh:!0,render:function(){return Object(A.jsx)(S.a,{to:"/new/1"})}}),Object(A.jsx)(S.b,{exact:!0,path:"/new/:page",component:Re}),Object(A.jsx)(S.b,{exact:!0,path:"/top/:page",component:Be}),Object(A.jsx)(S.b,{exact:!0,path:"/login",component:me}),Object(A.jsx)(S.b,{exact:!0,path:"/signup",component:de}),Object(A.jsx)(S.b,{exact:!0,path:"/callback",component:B.a}),Object(A.jsx)(S.b,{exact:!0,path:"/submit",component:Ie}),Object(A.jsx)(S.b,{exact:!0,path:"/search",component:Ne}),Object(A.jsx)(S.b,{exact:!0,path:"/submitted/:username/:page",component:Ye}),Object(A.jsx)(S.b,{exact:!0,path:"/comments/:username/:page",component:Ke}),Object(A.jsx)(S.b,{exact:!0,path:"/post",component:Ve}),Object(A.jsx)(S.b,{exact:!0,path:"/user",component:Fe})]})]})})}),n&&Object(A.jsx)(E.a,{xs:0,md:6,children:Object(A.jsx)(Ge,{className:"sider",onBreakpoint:function(e){console.log("broken")},width:"100%",children:Object(A.jsx)(D,{})})})]})})]})})},Xe=n(321),Ze=n(327),et=n(319),tt=new(n(191).a)({uri:"ws://".concat(j.hasura_endpoint),credentials:"include",options:{reconnect:!0}}),nt=new Xe.a({uri:"http://".concat(j.hasura_endpoint),cache:new Ze.a,link:tt});r.a.render(Object(A.jsx)(l.a,{children:Object(A.jsx)(et.a,{client:nt,children:Object(A.jsx)(We,{})})}),document.getElementById("root"))}},[[305,1,2]]]);
//# sourceMappingURL=main.6decb326.chunk.js.map